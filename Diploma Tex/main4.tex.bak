\documentclass[bachelor, och, diploma]{SCWorks}
% параметр - тип обучения - одно из значений:
%    spec     - специальность
%    bachelor - бакалавриат (по умолчанию)
%    master   - магистратура
% параметр - форма обучения - одно из значений:
%    och   - очное (по умолчанию)
%    zaoch - заочное
% параметр - тип работы - одно из значений:
%    referat    - реферат
%    coursework - курсовая работа (по умолчанию)
%    diploma    - дипломная работа
%    pract      - отчет по практике
% параметр - включение шрифта
%    times    - включение шрифта Times New Roman (если установлен)
%               по умолчанию выключен
\usepackage{mathtext}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage[sort,compress]{cite}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyvrb}
\usepackage{longtable}
\usepackage{array}
\usepackage{cite}
\usepackage[english,russian]{babel}


%\usepackage[colorlinks=true]{hyperref}


\newcommand{\eqdef}{\stackrel {\rm def}{=}}


\newtheorem{theorem}{Теорема}
\newtheorem{df}{Определение}[section]
\newtheorem{Prop}{Предложение}
\newtheorem{Lm}{Лемма}
\newtheorem{Con}{Следствие}
\newtheorem{exmp}{Пример}
\begin{document}

% Кафедра (в родительном падеже)
\chair{компьютерной алгебры и теории чисел}

% Тема работы
\worktitle{Эллиптические криптосистемы}

% Курс
\course{4}

% Группа
\group{421}

% Факультет (в родительном падеже) (по умолчанию "факультета КНиИТ")
\department{Механико-математического факультета}

% Специальность/направление код - наименование
\napravlenie{010200 "--- Математика и компьютерные науки}
%\napravlenie{010500 "--- Математическое обеспечение и администрирование информационных систем}
%\napravlenie{230100 "--- Информатика и вычислительная техника}
%\napravlenie{231000 "--- Программная инженерия}
%\napravlenie{090301 "--- Компьютерная безопасность}

% Для студентки. Для работы студента следующая команда не нужна.
%\studenttitle{Студентки}

% Фамилия, имя, отчество в родительном падеже
\studentName{Каймашникова Всеволода Александровича}

% Заведующий кафедрой
\chtitle{Профессор, доктор} % степень, звание
\chname{В. ~Н. ~Кузнецов}

%Научный руководитель (для реферата преподаватель проверяющий работу)
\satitle{доцент, к. ф.-м. н.} %должность, степень, звание
\saname{В. ~В. ~Кривобок}

% Руководитель практики от организации (только для практики,
% для остальных типов работ не используется)
%\patitle{к.ф.-м.н., доцент}
%\paname{А.~С.~Петров}

% Семестр (только для практики, для остальных
% типов работ не используется)
%\term{2}

% Наименование практики (только для практики, для остальных
% типов работ не используется)
%\practtype{производственно-технологическая}

% Продолжительность практики (количество недель) (только для практики,
% для остальных типов работ не используется)
%\duration{3}

% Даты начала и окончания практики (только для практики, для остальных
% типов работ не используется)
%\practStart{01.01.2012}
%\practFinish{01.01.2012}

% Год выполнения отчета
\year{2015}

\MakeTitle

% Включение нумерации рисунков, формул и таблиц по разделам
% (по умолчанию - нумерация сквозная)
% (допускается оба вида нумерации)
%\secNumbering


\tableofcontents

% Раздел "Обозначения и сокращения". Может отсутствовать в работе
%\abbreviations

% Раздел "Определения". Может отсутствовать в работе
%\definitions

% Раздел "Определения, обозначения и сокращения". Может отсутствовать в работе.
% Если присутствует, то заменяет собой разделы "Обозначения и сокращения" и "Определения"
%\defabbr


% Раздел "Введение"
\intro
Средства и системы криптографической защиты информации играют важную роль в современных компьютерных информационных системах, используемых в сфере финансовой и коммерческой деятельности. Интерес к ним обусловлен не только возрастающими общественными потребностями в переводе экономических и госcударственно-правовых отношений на 'электронную основу', но и сильно расширившимися возможностями передачи, обработки и хранения информации в распределенных вычислительных системах. Применение специальных криптографических протоколов и криптосистем позволяет осуществлять многообразные экономические отношения 'дистанционно', исключая необходимость личной встречи участников этих отношений, а также поддерживать при этом должную финансовую и правовую дисциплину.

В 1985 году Нил Коблиц и Виктор Миллер независимо предложили использовать в криптографии некоторые алгебраические свойства эллиптических кривых. С этого момента началось бурное развитие нового направления в криптографии, для которого используется термин криптография на эллиптических кривых (Elliptic Curve Cryptography, сокращенно ECC). Криптосистемы с открытым ключом на эллиптических кривых обеспечивают такую же функциональность, как и алгоритм RSA. Однако их криптостойкость основана на другой проблеме, а именно на проблеме дискретного логарифма в группе точек эллиптической кривой (Elliptic Curve Discrete Logarithm Problem, сокращенно ECDLP). В настоящее время лучшие алгоритмы для решения ECDLP имеют экспоненциальное время работы, в отличие от алгоритмов для решения проблемы простого дискретного логарифма и проблемы факторизации целого числа, которые имеют субэкспоненциальное время работы.

Эллиптические кривые являются одним из основных объектов изучения в современной теории чисел и криптографии. Эллиптическая криптография образует самостоятельный раздел криптографии, посвященный изучению криптосистем на базе эллиптических кривых.

\section{Базовые понятия о криптосистемах}
\subsection{Основные сведенья}
Криптография изучает методы пересылки сообщений в замаскированном виде, при которых только намеченные отправителем получатели могут удалить маскировку прочитать сообщение. Предназначенное для пересылки сообщение называется открытым текстом, а замаскированное сообщение шифрованным текстом или кратко шифртекстом. Открытый текст и шифртекст записываются в некоторых алфавитах; обычно, но не всегда, эти алфавиты совпадают и состоят из некоторого числа $N$ букв. Термин «буква» (или «символ») может относится не только к обычным буквам, но также к цифрам, к пробелам, к знакам пунктуации и ко всяким другим символам, используемым при записи сообщения. (Если мы не включим, например, пробелы, то все слова слипнутся и сообщение будет трудно читать.) Процесс преобразования открытого текста в шифртекст называется шифрованием (или зашифрованием), а обратная процедура называется дешифрованием расшифрованием).

Открытый и шифрованный тексты разбиваются на элементарные сообщения («элементы»). Элементом может быть отдельная буква, пара букв (биграмма), тройка букв (триграмма) или даже блок из 50 букв. Шифрующее преобразование является функцией, которая преобразует элемент открытого текста в элемент шифртекста. Другими словами, это — отображение $f$ из множества $P$ всех возможных элементов открытого текста в множество $C$ всех возможных элементов шифртекста. Будем всегда предполагать, что это отображение взаимно однозначное, т. е. для одного элемента шифртекста существует один и только один элемент открытого текста, из которого элемент шифртекста получается при шифровании. Дешифрующее преобразование действует в обратном направлении, это — функция $f^{-1}$ восстанавливающая открытый текст по шифртексту. Всю эту ситуацию можно схематически изобразить диаграммой $$P \xrightarrow{f} C \xrightarrow{f^{-1}} P.$$
Любая такая конструкция называется криптосистемой.

На самом деле термин «криптосистема» чаще применяется к целому семейству таких преобразований, зависящих от выбора некоторых параметров (от них могут зависеть как отображение $f$, так и множества $P$ и $C$). Шифрующее преобразование можно задать: алгоритмом, единым для всего семейства, и значениями параметров. Значения параметров называются ключом шифрования $K_E$. На практике считается, что алгоритм известен (т.е. общий вид процедуры шифрования сохранить в тайне нельзя). Однако ключи легко меняются и, если это необходимо, держатся в секрете. Для дешифрования (т.е. вычисления $f^{-1}$ ) также необходимы алгоритм и ключ. Этот ключ называется ключом дешифрования $K_D$.

Под классической криптосистемой (иначе, системой с секретным ключом или симметричной криптосистемой понимается криптосистема, в которой, имея информацию о преобразовании шифрования, можно реализовать
преобразование дешифрования примерно за такое же время, что и преобразование шифрования.

По определению, криптосистема с открытым ключом обладает тем свойством, что знание шифрующего преобразования не позволяет по ключу шифрования найти ключ дешифрования, избежав чрезвычайно длинных вычислений. Другими словами, шифрующая функция $f: P \to C$ легко вычисляется, если ключ шифрования $K_E$ известен, но вычислять значения обратной функции $f^{-1}: C \to P$ очень сложно. С точки зрения практической вычислимости это значит, что функция $f^{-1}$ необратима (без дополнительной информации — ключа дешифрования $K_D$). Таким образом, функция $f$ — это легко вычислимая функция, для которой обратную функцию $f^{-1}$ вычислить трудно, если не иметь некоторой дополнительной информации сверх той, что используется при вычислении $f$. Обратная функция $f^{-1}$ , однако, легко вычислима, если известна дополнительная информация $K_D$ — ключ дешифрования.

Примерами таких криптосистем являются криптосистема на эллиптических кривых благодаря проблеме дискретного логарифма в группе точек эллиптической кривой (Elliptic Curve Discrete Logarithm Problem, сокращенно ECDLP) и криптосистема RSA, в которой стоит сложная задача факторизации больших чисел.

\subsection{Электронная подпись}
Часто одной из наиболее важных частей сообщения является подпись. Если сообщение имеет особенную важность, могут
потребоваться дополнительные способы заверения подлинности сообщения. А в электронных средствах связи, где нельзя передать физическую подпись, приходится полагаться совершенно на другие методы.

Криптография с открытым ключом предоставляет простое решение этой задачи аутентикации. Пусть А (Алиса) и В (Боб) — два пользователя системы. Пусть $f_A$ - шифрующее преобразование, которым должен воспользоваться любой, кто отправляет сообщение Алисе, а $f_B$ — соответствующее преобразование для Боба. Для простоты считаем, что множества $P$ и $C$ элементов открытого и шифрованного текстов совпадают и одинаковы у всех пользователей. Пусть $P$ — подпись Алисы (включающая в себя, возможно,
идентификационный номер Алисы, время отправления сообщения и т.п.). Если Алиса просто пошлет Бобу некоторое сообщение $f_B(P)$, то (поскольку способ вычисления $f_B(P)$ общеизвестен) нет способа проверки, гарантирующего, что подпись принадлежит Алисе. Однако, если в начале или конце сообщения будет помещено $f_Bf^{-1}_A(Р)$, то Боб, применив $f^{-1}_B$ , дешифрует сообщение, включая этот добавок, и все превратится в открытый текст, за исключением добавка, который примет вид $f^{-1}_A(Р)$. Так как Боб знает, что сообщение должно было быть послано от Алисы, то он применит к добавку $f_A$ (ключ Алисы открыт и ему известен) и получит $P$. Так как никто, кроме Алисы, не может воспользоваться функцией $f^{-1}_A$ , обратной к $f_A$, то он удостоверяется в том, что сообщение послано Алисой.

\section{Теория эллиптических кривых}

\subsection{Основные факты}
В этом параграфе мы предполагаем, что $K-$ поле: либо поле $\mathbb{R}$
вещественных чисел, либо поле $\mathbb{Q}$ рациональных чисел, либо поле $\mathbb{C}$
комплексных чисел, либо поле $F_q$ из $q = p^r$ элементов.

\begin{df}
Пусть K $-$ поле характеристики, отличной
от $2$, $3$, и $x^3+ax+b$ (где $a, b\in K$) $-$ кубический многочлен без кратных
корней. Эллиптическая кривая над $К$ - это множество точек $(x,y), x,y\in K$, удовлетворяющих уравнению
\begin{equation}
\label{1}
y^2 = x^3 + ax + b
\end{equation}
вместе с единственным элементом, обозначаемым  $O$ и называемым 'точка в ~бесконесности'.
\end{df}

Если $K$ $-$ поле характеристики $2$, то эллиптическая кривая над
$K~-$ это множество точек, удовлетворяющих уравнению либо типа

\begin{equation}
\label{2a}
y^2 + cy = x^3 + ax + b,
\end{equation}
либо типа
\begin{equation}
\label{2b}
y^2 + xy = x^3 + ax^2 + b
\end{equation}
(здесь кубические многочлены в правых частях могут иметь кратные
корни), вместе с 'точкой в бесконечности' $O$.

Если $K~-$ поле характеристики $3$, то эллиптическая кривая над $K~-$ это множество
точек, удовлетворяющих уравнению
\begin{equation}
\label{3}
y^2=x^3+ax^2+bx+c
\end{equation}
(здесь кубические многочлены в правых частях могут иметь кратные
корни), вместе с 'точкой в бесконечности' $O$.

\begin{Prop}
Имеется общая форма уравнения эллиптической кривой, которая применима при любом поле: $$y+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6$$
B случае, когда $char K\ne 2$, ее можно привести к виду $$y^2=x^3+ax^2+bx+c$$
или к виду $$y^2=x^3+bx+c,$$ если $K > 3$.
В случае, когда поле $K$ имеет характеристику $2$, это уравнение преобразуется либо к виду \ref{2a}), либо к виду \ref{2b}).
\end{Prop}

Отметим чрезвычайно важное свойство множества точек эллиптической кривой: они образуют абелеву группу.
Чтобы объяснить наглядно, как это получается, временно будем полагать,
что $K = \mathbb{R}$, т.е. что эллиптическая кривая $-$ обычная плоская
кривая (с добавлением еще одной точки $O$ 'в бесконечности').

\begin{df}
Пусть $E~-$ эллиптическая кривая над
вещественными числами, и пусть $P$ и $Q~-$ две точки на $E$. Определим
точки $-P$ и $P+Q$ по следующим правилам.

\begin{enumerate}
\item Если $P~-$ точка в бесконечности $O$, то $-P=O$ и $P+Q=Q$,
т.е. $O~-$ тождественный элемент по сложению ('нулевой элемент')
группы точек. В следующих пунктах предполагается, что ни $P$, ни $Q$
не являются точками в бесконечности.
\item Точки $P=(x,y)$ и $-P$ имеют одинаковые $x$-координаты, а их
$y$-координаты различаются только знаком, т.е. $-(x,y)=(x, -y)$.
Из \ref{1} сразу следует, что $(x,-y)$ $-$ также точка на $E$.
\item Если $P$ и $Q$ имеют различные $x$-координаты, то прямая $l=\overline{PQ}$
имеет с $E$ еще в точности одну точку пересечения $R$ (за исключением
двух случаев: когда она оказывается касательной в $P$, и мы тогда
полагаем $R=P$, или касательной в $Q$, и мы тогда полагаем $R=Q$).
Определяем теперь $P+Q$ как точку $-R$, т.е. как отражение от оси
$x$ третьей точки пересечения. Геометрическое построение, дающее
$P+Q$, приводится ниже в примере 1.
\item Если $Q=-P$ (т.е. $x$-координата $Q$ та же, что и у $P$, а
$y$-координата отличается лишь знаком), то полагаем $P+Q=O$
(точке бесконечности; это является следствием правила 1).
\item Остается возможность $P=Q$. Тогда считаем, что $l$ $-$ касательная к кривой в точке $P$.
пусть $R$ $-$ единственная другая точка
пересечения $l$ с $E$. полагаем $P+Q=-R$ (в качестве $R$ берем $P$, если
касательная прямая в $P$ имеет 'двойное касание', т.е. если $P$ есть
точка перегиба кривой).
\end{enumerate}
\end{df}

\begin{exmp}

На рисунке ниже изображены эллиптическая кривая $y^2=x^3-x$ в плоскости $xy$ и
типичный случай сложения точек $P$ и $Q$. Чтобы найти $P+Q$, проводим прямую $PQ$ и в качестве $P+Q$
берем точку, симметричную относительно оси $x$ третьей точке, определяемой пересечением прямой $PQ$
и кривой. Если бы $P$ совпадала с $Q$, т.е. если бы нам нужно было найти $2P$, мы использовали бы
касательную к кривой в $P$; тогда точка $2P$ симметрична третьей точке, в которой эта касательная
пересекает кривую.
\end{exmp}
{
\includegraphics[width=90mm]{page.jpeg}
%\label{page}
}

\begin{df}
Точки конечного порядка.

Порядком $N$ точки $P$ на эллиптической кривой называется такое наименьшее натуральное число,
что $NP=0$; конечно, такого конечного $N$ может и не существовать.
\end{df}

\begin{exmp}
Найти порядок точки $P=(2,3)$ на $y^2=x^3+1$.

Решение.
Находим, что $2P=(0,1)$ и $4P=2(2P)=(0,-1)$. поэтому $4P=-2P$ и,
следовательно, $6P=0$. Тем самым порядок $P$ может быть равен $2$, $3$
или $6$. Но $2P=(0,1)\ne0$, а если бы $P$ имела порядок $3$, то было бы
$4P=P$, что неверно. Итак, $P$ имеет порядок $6$.
\end{exmp}

\subsection{Арифметика}
$F^*_q$ $-$ мультипликативная группа конечного поля.
Для эллиптических кривых аналогом умножения двух элементов группы $F^*_q$ служит сложение двух точек
эллиптической кривой $E$, определенной над $F^*_q$. Таким образом, аналог
возведения в степень $k$ элемента из $F^*_q$ $-$ это умножение точки $P\in E$
на целое число $k$.

Определим операцию сложения двух точек эллиптической кривой алгебраически.
Запишем $P+Q=-R$.

Пусть координатами точки $P$ будут $(x_P, y_P)$, а координатами точки $Q$ соответственно $(x_Q, y_Q)$.

$$x_{P+Q} = \lambda^2 - x_P - x_Q$$

$$y_{P+Q} = \lambda(x_P - x_{P+Q}) - y_P,$$
где

$$\lambda = (y_P - y_Q)/(x_P - x_Q),~P\neq Q$$

$$\lambda = (3x_P^2 + a)/(2y_P),~P=Q,$$
где $a$ коэффициент при $x$ в правой части уравнения \ref{1}

\begin{exmp}
Чтобы найти $100P$, записываем $$100P=2(2(P+2(2(2(P+2P)))))$$
и приходим к цели, производя $6$ удвоений и $2$ сложения точек на кривой.
\end{exmp}

\begin{df}
Пусть $G$ $-$ конечная группа, $b$ $-$ элемент
группы $G$ и $y$ $-$ элемент группы $G$, являющийся степенью $b$. Любое
целое число $x$, для которого $b^x=y$, называется дискретным 
логарифмом $y$ по основанию $b$.
\end{df}

\begin{df}
Пусть $E$ $-$ эллиптическая кривая над $F_q$
и $B$ $-$ точка на $E$. Задачей дискретного логарифмирования на $E$ (с
основанием $B$) называется задача нахождения для данной точки $P\in E$
такого целого числа $x\in Z$ (если оно существует), что $xB=P$.
\end{df}

\section{Криптосистемы на эллиптических кривых}

Мы намереваемся кодировать наши открытые тексты точками некоторой заданной
эллиптической кривой $E$, определенной над конечным полем $F_q$. Мы хотим
это осуществить простым и систематическим способом так, чтобы
открытый текст $m$ (который можно рассматривать как целое число
из некоторого интервала) можно было легко прочитать, зная координаты соответствующей точки $P_m$. Заметим, что это 'кодирование' $-$
не то же самое, что засекречивание.
\subsection{Система Диффи-Хеллмана обмена ключами}
Так как криптосистемы с открытым ключом значительно медленнее классических
криптосистем (по крайней мере, при нынешнем состоянии науки и
техники), то разумнее использовать их в качестве дополнения к
классическим криптосистемам, с помощью которых и передаются
сообщения. Зато процедуру согласования ключей классической
криптосистемы можно очень эффективно реализовать с помощью системы
с открытым ключом. Первая такая детально проработанная схема,
предложенная Диффи и Хеллманом, основана на задаче дискретного
логарифмирования.

Пусть два пользователя (Аида и Бернардо) хотят согласовать
ключ $-$ случайный элемент из $F^*_q$, $-$ посредством которого они
будут зашифровывать переписку между собой. Аида выбирает
случайное число $a$ между $1$ и $q-1$, которое она держит в секрете,
вычисляет $g^a \in F^*_q$, которое объявляет открыто. Бернардо делает то же
самое: он случайно выбирает $b$ и объявляет $g^b \in F^*_q$. В качестве 
секретного ключа используется $g^{ab}$. Оба пользователя могут вычислить этот
ключ. Например, Аида знает $g^b$ (это открытая информация) и свой
собственный секретный ключ $a$. Однако посторонние знают только $g^a$
и $g^b$. Если для мультипликативной группы $F^*_q$ выполнено следующее
предположение, то посторонние не смогут определить ключ.

\begin{Prop} Диффи—Хеллмана. Сложность вычисления
$g^{ab}$ по $g^a$ и $g^b$ чрезвычайно велика.
\end{Prop}
Предположение Диффи-Хеллмана априори не слабее предположения о чрезвычайной сложности дискретного логарифмирования в
конечной группе. Если бы можно было вычислять дискретные логарифмы, то, очевидно, предположение Диффи-Хеллмана было бы неверным. Некоторые считают, что справедливо и обратное, однако пока этот вопрос остается открытым. Другими словами, никто еще не
предложил способ получения $g^{ab}$ из $g^a$ и $g^b$ без использования $a$ и $b$.
Однако вполне возможно, что такой способ существует. 
\subsubsection{Ключевой обмен Диффи-Хеллмана на эллиптических кривых}

Предположим, что Маша и Петя хотят договориться о ключе, которым
будут впоследствии пользоваться в некоторой классической
криптосистеме. прежде всего они открыто выбирают какое-либо конечное поле
$F_q$ и какую-либо эллиптическую кривую $E$ над ним. Их ключ
строится по случайной точке $P$ на этой эллиптической кривой. Если у них
есть случайная точка $P$, то, например, ее $x$-координата дает
случайный элемент $F_q$, который можно затем преобразовать в $r$-разрядное
целое число в $p$-ичной системе счисления (где $q=p^r$), и это число
может служить ключом в их классической криптосистеме. (Здесь мы
пользуемся словом случайный в неточном смысле; мы лишь хотим
сказать, что выбор из некоторого большого множества допустимых
ключей произволен и непредсказуем). Они должны выбрать точку $P$
так, чтобы все их сообщения друг другу были открытыми и все же
никто, кроме них двоих, ничего бы не знал о $P$.

Маша и Петя первым делом открыто выбирают точку $B \in E$
в качестве основания. Мы, однако, не требуем,
чтобы $B$ была образующим элементом в группе точек кривой $E$. Эта
группа может и не быть циклической. Даже если она циклическая,
мы не хотим тратить время на проверку того, что $B$ $-$ образующий
элемент (или даже на нахождение общего числа $N$ точек, которое нам
не понадобится в последующем). Нам хотелось бы, чтобы
порожденная $B$ подгруппа была большой, предпочтительно того же порядка
величины, что и сама $E$. Предположим, что $B$ $-$ взятая открыто точка на $E$ весьма большого
порядка (равного либо $N$, либо большому делителю $N$).
Чтобы образовать ключ, Маша вначале случайным образом
выбирает целое число $a$, сравнимое по порядку величины с $q$ (которое
близко к $N$); это число она держит в секрете. Она вычисляет $aB\in E$
и передает эту точку открыто. Петя делает то же самое: он выбирает случайно $b$ и открыто передает $bB\in B$. Тогда используемый
ими секретный ключ $-$ это $p=abB \in E$. Оба пользователя могут
вычислить этот ключ. Например, Маша знает $bB$ (точка была передана открыто) и свое собственное секретное $a$. Однако любая третья
сторона знает лишь $aB$ и $bB$. Кроме решения задачи дискретного
логарифмирования $-$ нахождения $a$ по $B$ и $aB$ (или нахождения $b$ по $B$
и $bB$), $-$ пока нет способа найти $abB$, зная лишь $aB$ и $bB$.

\subsection{Криптосистема Мэсси—Омуры для передачи сообщений}
Предположим, что все согласились использовать конечное поле $F_q;$
оно зафиксировано и общеизвестно. Каждый пользователь системы
втайне выбирает такое случайное целое $e$ между $0$ и $q-1$, что
$НОД(e, q—1)=1$, и с помощью алгоритма Евклида вычисляет
обратное к нему число $d = e (mod q-1)$, т.е. $de = 1 (mod q-1)$. Если
Алиса (пользователь А) намерена передать сообщение $P$ Бобу, она
сначала посылает ему элемент $P^{e_A}$. Это послание для Боба 
бессодержательно, так как он не знает $d_A$ (или $e_A$, что то же самое) и не может
восстановить Р. Не пытаясь понять смысл сообщения, Боб возводит
его в свою степень $e_B$ и отсылает $P^{e_Ae_B}$ обратно Алисе. Третий шаг
состоит в том, что Алиса несколько «распутывает» сообщение, 
возводя его в степень $d_A$; так как $P^{e_Ad_A}=P$, то, по
сути дела, она отсылает Бобу $P^{e_B}$, который теперь может прочитать
сообщение, возведя его в степень $d_B$.
Весьма простая идея этой системы может быть реализована и в
схемах, где используются процедуры, отличные от возведения в 
степень в конечных полях. Однако не все так просто. Прежде всего, 
отметим, что при использовании системы Мэсси-Омуры абсолютно 
необходима хорошая схема подписи сообщений. Без нее любое 
постороннее лицо $C$, которому сообщение $P$ не предназначено, может 
представиться Бобом и вернуть Алисе сообщение $P^{e_Ae_C}$. Алиса, не зная, что
оно прислано самозванцем, пользовавшимся своим ключом $e_C$, 
продолжит процедуру, возведя сообщение в степень $d_A$, дав тем самым $С$
возможность прочитать сообщение. Поэтому промежуточное сообщение $P^{e_Ae_B}$ от Боба Алисе должно сопровождаться аутентификацией, т.е.
некоторым сообщением в схеме подписи, которое может послать только Боб.

Кроме того, важно, чтобы такие пользователи, как $В$ или $С$, 
которые после дешифрования различных сообщений $P$ будут знать 
пары $(P, P^{e_A})$, не могли воспользоваться этим для определения $e_A$. Так,
если бы Боб мог решать задачу дискретного логарифмирования в $F^*_q$
и по $P$ и $P^{e_A}$ определять, каким должно быть $e_A$, то он мог бы легко
вычислить $d_A = e_A (mod q-1)$ и затем перехватывать и читать все
дальнейшие сообщения Алисы, кому бы они ни были адресованы. 
\subsubsection{Система Мэсси—Омуры на эллиптических кривых}

Это криптосистема с открытым ключом для передачи
элементов сообщения $m$, которые мы теперь предположим представленными точками $P_m$
фиксированной (и не скрываемой) эллиптической
кривой $E$ над $F_q$ ($q$ берется большим). предполагается также, что
общее число $N$ точек на $E$ вычислено и не составляет секрета. Каждый
пользователь системы секретно выбирает такое целое случайное
число $e$ между $1$ и $N$, что $НОД(e, N) = 1$. Используя алгоритм Евклида,
он находит затем обратное $e^{-1}$ к числу $e$ по модулю $N$, т.е. такое
целое число $d$, что $de\equiv 1(mod N)$. Если Алиса хочет послать
Вове сообщение $P_m$, то она сначала посылает ему точку $e_AP_m$ (индекс
$A$ указывает на пользователя Алису). Это ничего не говорит Вове,
который, не зная ни $e_A$, ни $d_A$, не может восстановить $P_m$. Однако,
не придавая этому значения, он умножает ее на свое $e_B$ и посылает
обратно Алисе $e_Be_AP_m$. На третьем шаге Алиса должна частично
раскрыть свое сообщение, умножив $e_Be_AP_m$ на $d_A$. Так как $NP_m=0$ и
$d_Ae_A\equiv 1 (mod N)$, при этом получается точка $e_BP_m$, которую Алиса
возвращает Вове. Тот может теперь прочитать сообщение, умножив точку $e_BP_m$ на $d_B$.

Заметим, что злоумышленник может знать $e_AP_m$, $e_Be_AP_m$ и
$e_BP_m$. Если бы он умел решать задачу дискретного логарифмирования
на $E$, то он мог бы определить $e_B$ по первым двум точкам, вычислить
$d_B\equiv e^{-1}_B (mod N)$ и $P_m=d_Be_BP_m$.

\subsection{Система Эль-Гамаля на эллиптических кривых}

Это $-$ другая криптосистема с открытым ключом для передачи сообщений $P_m$. Как и в описанной
выше системе ключевого обмена, мы исходим из данных несекретных:
\begin{enumerate}
\item конечного поля $F_q$
\item определенной над ним эллиптической кривой $E$
\item точки 'основания' $B$ на ней
\end{enumerate}
Знать общее число $N$ точек на $E$
нам не нужно. Каждый из пользователей выбирает случайное целое
число $a$, которое держит в секрете, затем находит и делает
общедоступной точку $aB$.
Чтобы послать Борису сообщение $P_m$, Анна выбирает случайно
целое число $k$ и посылает пару точек $(kB, P_m+k(a_BB))$ (где $a_BB$ $-$
открытый ключ Бориса). Чтобы прочитать сообщение, Борис
умножает первую точку из полученной пары на свое секретное число $a_B$ и
вычитает результат умножения из второй точки:
\begin{equation}
P_m+k(a_BB)-a_B(kB)=P_m.
\end{equation}
Таким образом, Анна посылает замаскированное $P_m$ вместе с
'подсказкой' $kB$, при помощи которой можно снять 'маску' $ka_BB$, если
знать секретное число $a_B$. Злоумышленник, который умеет решать
задачу дискретного логарифмирования на Е, может, конечно, найти
$a_B$, зная $a_BB$ и $B$.

\subsection{Выбор кривой и точки}

Существуют различные способы выбора эллиптической кривой и (в системах Диффи-Хеллмана и Эль-Гамаля) точки $B$ на ней.

Случайный выбор $(E, B)$. Взяв какое-либо большое конечное
поле $F_q$, можно следующим образом осуществить одновременный
выбор $E$ и $B=(x, y)\in E$. Будем предполагать, что характеристика $p$
поля $F_q$ больше $3$, так что эллиптическая кривая задана уравнением
\ref{1}; при $q=2^r$ или $3^r$ нетрудно сделать очевидные изменения в
дальнейшем изложении. Выбираем сначала случайным образом три
элемента из $F^*_q$ в качестве $x$, $y$, $a$. Далее полагаем $b=y^2-(x^3+ax).$
Убеждаемся в том, что кубический многочлен $x^3+ax+b$ не имеет кратных корней, что равносильно проверке условия $4a^3+27b^2\ne0$.
Если это условие не выполняется, берем другую случайную тройку
$x$, $y$, $a$. полагаем $B=(x, y)$. Тогда $B$ $-$ точка, на эллиптической кривой $y^2=x^3+ax+b$.

Для нахождения $N$ количества точек эллиптической рассмотри следующую теорему
\begin{theorem} Xассе.
Пусть $N$ $-$ число $F_q$ $-$ точек на эллиптических кривой, определённой над $F_q$. Тогда
$$|N-(q+1)|\leq 2\sqrt{q}$$
\end{theorem}

Далее рассмотрим алгоритм Шуфа.

Алгоритм Шуфа был первым полиномиальным алгоритмом подсчета
количества точек на эллиптической кривой, его трудоемкость составляет
$O(log^9p)$ операций по модулю $р$.


\section{Практическая часть}
\input{code.tex}

\section{Заключение}

Актуальность данной темы очень велика в наше время. Как было отмечено во введении: средства и системы криптографической защиты информации играют важную роль в современных компьютерных информационных системах, используемых в сфере финансовой и коммерческой деятельности.

В данной работе изложены базовые понятия теории эллиптических кривых, необходимые для реализации криптографических систем на них. Рассмотрены основные алгоритмы арифметики точек эллиптической кривой, а также некоторые способы генерации кривых, пригодных для использования в криптографических системах.
Даны алгоритмы шифрования Эль-Гамаля, Мэсси-Омуры, Диффи-Хеллмана с использованием эллиптических кривых с примерами.

Основным преимуществом эллиптической криптографии является малый размер ключа относительно других схем асимметричного шифрования (например RSA). Это свойство особенно важно при реализации криптографических протоколов в условиях ограниченности ресурсов памяти и производительности, например при программировании смарт-карт. Также ясно, что с улучшением производительности компьютеров шифры постепенно будут становиться все более уязвимыми при малых длинах ключа.

А с увеличение длины ключа преимущества схем на эллиптических кривых над другими схемами шифрования возрастает многократно. За счет меньшей длины ключа возрастает и эффективность вычислительных процессов. Также следует отметить, что помимо общих алгоритмов арифметики эллиптических кривых, существует много специфических алгоритмов, разработанных для кривых специального вида (например, кривых Коблица), которые позволяют добиться еще большего преимущества в эффективности.
\begin{thebibliography}{99}

\bibitem{a}
Коблиц Н. Курс теории чисел и криптографии. М.: Научное изд-во ТВп, 2001

\bibitem{b}
А.А. Болотов Элементарное введение в эллиптическую криптографию, 2006

\bibitem{c}
Hankerson D. Guide to Elliptic Curve Cryptography, 2004

\bibitem{d}
Washington, Lawrence C. Elliptic Curves: Number Theory and Cryptography, 2008

\bibitem{e}
Нестеренко Ю.В. Теория чисел: учебник для студ. высш. учебных заведений / Ю.В. Нестеренко - М.: Издательский центр 'Академия', 2008

\bibitem{f}
Ростовцев А.Г., Моховенко Е.Б. Теоритическая криптография. Спб.: Изд-во АНО НпО 'профессионал', 2004

\bibitem{g}
Коблиц Н. Введение в элиптические кривые и модулярные формы: пер. с англ. - М.: Мир, 1988

\bibitem{h}
Лидл Р., Нидеррайтер Г. Конечные поля. пер. с англ. - М.: Мир, 1988 Т.1

\end{thebibliography}

\appendix

\end{document} 